<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Routine Tracker</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0F6F4F" />

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>

  <!-- ================= AUTH ================= -->
  <div id="authView" class="card">
    <h1 class="page-title">Login</h1>

    <input id="email" type="email" placeholder="Email" />
    <input id="password" type="password" placeholder="Password" />

    <button id="btnLogin">Login</button>
    <button id="btnRegister" class="secondary">Register</button>

    <button id="btnForgotPassword" class="secondary">Forgot password</button>

    <p id="authMsg" class="muted"></p>
  </div>

  <!-- ================= RESET PASSWORD ================= -->
  <div id="resetView" class="card" style="display:none;">
    <h1 class="page-title">Reset Password</h1>

    <input id="newPassword" type="password" placeholder="New password" />
    <input id="newPassword2" type="password" placeholder="Confirm new password" />

    <button id="btnSetNewPassword">Set Password</button>
    <button id="btnBackToLogin" class="secondary">Back to Login</button>

    <p id="resetMsg" class="muted"></p>
  </div>

  <!-- ================= MAIN MENU ================= -->
  <div id="menuView" class="card" style="display:none;">
    <h1 class="page-title">Main Menu</h1>

    <div class="navRow">
      <button id="btnGoTracker" class="menuBtn">Routine Tracker</button>
      <button id="btnGoPrevious" class="menuBtn">Historic Routine Tracker</button>
    </div>

    <div class="navRow">
      <button id="btnGoAccident" class="menuBtn">Accident & Illness</button>
      <button id="btnGoHistoricAI" class="menuBtn">Historic Accident & Illness</button>
    </div>

    <div class="navRow">
      <button id="btnGoNewMedication" class="menuBtn">New Medication</button>
      <button id="btnGoExport" class="menuBtn">Export Data</button>
    </div>

    <div class="logout-wrapper">
      <button id="btnLogout">Logout</button>
    </div>
  </div>

  <!-- ================= ROUTINE TRACKER ================= -->
  <div id="trackerView" style="display:none;">
    <h1 class="page-title">Routine Tracker</h1>

    <div class="dayBar">
      <button id="btnPrevDay" class="miniBtn">◀</button>
      <div id="trackerDate" class="dateText"></div>
      <button id="btnNextDay" class="miniBtn">▶</button>
    </div>

    <div id="historicNotice" class="historic-label" style="display:none;">
      Historic day
    </div>

    <!-- Child -->
    <div class="card">
      <h3>Child</h3>
      <select id="childSelect"></select>

      <div class="row">
        <input id="childName" placeholder="New child name" />
        <button id="btnAddChild">Add Child</button>
      </div>

      <p id="childInfo" class="muted"></p>
    </div>

    <!-- Sleep -->
    <div class="card" id="sleepCard">
      <h3>Sleep</h3>

      <button id="btnSleepStart">Start Sleep</button>
      <button id="btnSleepEnd">End Sleep</button>

      <textarea id="sleepNote" placeholder="Sleep notes"></textarea>

      <div class="row">
        <input id="sleepStartManual" type="datetime-local" />
        <input id="sleepEndManual" type="datetime-local" />
      </div>

      <button id="btnAddSleepManual">Add Manual Sleep</button>

      <p><strong>Total sleep:</strong> <span id="sleepTotal">0.00h</span></p>
      <ul id="sleepList"></ul>
    </div>

    <!-- Meals -->
    <div class="card">
      <h3>Meals</h3>

      <select id="mealType">
        <option>Breakfast</option>
        <option>Morning Snack</option>
        <option>Lunch</option>
        <option>Afternoon Snack</option>
        <option>Dinner</option>
        <option>Bottle</option>
      </select>

      <select id="mealPercent">
        <option value="0">0%</option>
        <option value="25">25%</option>
        <option value="50">50%</option>
        <option value="75">75%</option>
        <option value="100">100%</option>
      </select>

      <input id="mealFood" placeholder="What was eaten" />
      <textarea id="mealNotes" placeholder="Meal notes"></textarea>

      <button id="btnAddMeal">Add Meal</button>
      <ul id="mealList"></ul>
    </div>

    <!-- Mood -->
    <div class="card">
      <h3>Mood</h3>

      <select id="moodPeriod">
        <option>Morning</option>
        <option>Afternoon</option>
        <option>Evening</option>
      </select>

      <select id="moodValue">
        <option>Calm</option>
        <option>Content</option>
        <option>Energetic</option>
        <option>Happy</option>
        <option>Fussy</option>
        <option>Irritable</option>
        <option>Unwell</option>
        <option>Sick</option>
      </select>

      <textarea id="moodNotes" placeholder="Mood notes"></textarea>

      <button id="btnAddMood">Save Mood</button>
      <ul id="moodList"></ul>
    </div>

    <!-- Medication -->
    <div class="card">
      <h3>Medication</h3>

      <select id="medSelect"></select>
      <input id="medDose" placeholder="Dose" />
      <input id="medTime" type="time" />
      <textarea id="medNotes" placeholder="Medication notes"></textarea>

      <button id="btnAddDose">Add Dose</button>
      <ul id="medList"></ul>
    </div>

    <button id="btnBackToMenu" class="secondary">Back to Menu</button>
  </div>

  <!-- ================= ACCIDENT & ILLNESS ================= -->
  <div id="accidentView" style="display:none;">
    <h1 class="page-title">Accident & Illness</h1>

    <div class="dayBar">
      <button id="btnAIPrevDay" class="miniBtn">◀</button>
      <div id="aiDate" class="dateText"></div>
      <button id="btnAINextDay" class="miniBtn">▶</button>
    </div>

    <div class="historic-label">
      If historic, stored at 10:06 automatically.
    </div>

    <!-- Accident + Illness UI is handled by JS -->
    <div id="aiContent"></div>

    <button id="btnAIBackToMenu" class="secondary">Back to Menu</button>
  </div>

  <!-- ================= NEW MEDICATION ================= -->
  <div id="newMedicationView" class="card" style="display:none;">
    <h1 class="page-title">New Medication</h1>

    <input id="newMedNameMenu" placeholder="Medication name" />
    <input id="newMedUnitMenu" placeholder="Unit (ml / mg)" />

    <textarea id="newMedNotes" placeholder="Notes"></textarea>

    <button id="btnAddMedMenu">Add Medication</button>
    <button id="btnMedBackToMenu" class="secondary">Back to Menu</button>

    <p id="medAdminMsg" class="muted"></p>
  </div>

  <!-- ================= EXPORT ================= -->
  <div id="exportView" class="card" style="display:none;">
    <h1 class="page-title">Export Data</h1>

    <p class="muted">Export routine, medication, accident & illness records.</p>

    <button id="btnExportCSV">Export CSV</button>
    <button id="btnExportPDF" class="secondary">Export PDF</button>

    <button id="btnExportBackToMenu" class="secondary">Back to Menu</button>
  </div>

  <!-- App logic -->
  <script src="app.js"></script>

</body>
</html>
