<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0B6B4F" />
  <title>Routine Tracker</title>

  <link rel="manifest" href="./manifest.json" />
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />

  <style>
    :root{
      --bg1:#EAF7F2;
      --bg2:#D9F0E8;
      --card:#F3FBF7;
      --card2:#EAF7F2;
      --primary:#0B6B4F;
      --primary2:#18A07A;
      --mint:#BFECE0;
      --text:#0E2A22;
      --muted:#3b5a52;
      --border:#cfe7de;

      --radius:16px;
      --pad:16px;
      --gap:12px;
      --controlH:46px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        repeating-linear-gradient(
          to bottom,
          var(--bg1),
          var(--bg1) 40px,
          var(--bg2) 40px,
          var(--bg2) 80px
        );
      min-height:100vh;
    }

    a{ color:inherit; }
    .hidden{ display:none !important; }

    /* Top banner */
    #offlineBanner{
      display:none;
      position:sticky;
      top:0;
      z-index:50;
      padding:10px 14px;
      background:#fff3cd;
      color:#664d03;
      border-bottom:1px solid #ffe69c;
      font-weight:600;
    }

    .container{
      max-width: 980px;
      margin: 0 auto;
      padding: 18px 14px 40px;
    }

    .pageTitle{
      text-align:center;
      font-size: 28px;
      font-weight: 800;
      margin: 8px 0 16px;
      letter-spacing:.2px;
    }

    .card{
      background: rgba(243,251,247,.92);
      border:1px solid var(--border);
      border-radius: var(--radius);
      padding: var(--pad);
      box-shadow: 0 10px 28px rgba(0,0,0,.06);
      margin-bottom: 16px;
    }

    .row{
      display:flex;
      gap:var(--gap);
      align-items:stretch;
      flex-wrap:wrap;
    }

    .row.nowrap{ flex-wrap:nowrap; }

    .col{ flex:1; min-width: 210px; }

    label{
      display:block;
      font-size: 13px;
      color:var(--muted);
      margin: 6px 0 6px;
      font-weight:650;
    }

    input, select, textarea{
      width:100%;
      border:1px solid var(--border);
      border-radius: 10px;
      padding: 10px 12px;
      background:#fff;
      color:var(--text);
      outline:none;
      height: var(--controlH);
      font-size: 14px;
    }

    textarea{
      height:auto;
      min-height: var(--controlH);
      resize: vertical;
      padding-top: 10px;
      line-height:1.3;
    }

    input:focus, select:focus, textarea:focus{
      border-color: rgba(24,160,122,.7);
      box-shadow: 0 0 0 3px rgba(24,160,122,.18);
    }

    .btn{
      height: var(--controlH);
      border:none;
      border-radius: 10px;
      padding: 0 14px;
      background: var(--primary);
      color:#fff;
      font-weight:800;
      cursor:pointer;
      white-space:nowrap;
    }

    .btn:hover{ background: #085a42; }
    .btn:active{ transform: translateY(1px); }

    .btn.secondary{
      background: var(--mint);
      color: var(--primary);
      font-weight:900;
    }
    .btn.secondary:hover{ filter: brightness(.95); }

    .btn.danger{
      background:#a73737;
    }
    .btn.danger:hover{ background:#8f2f2f; }

    .center{ justify-content:center; }

    .helpText{
      font-size: 13px;
      color: var(--muted);
      margin-top: 10px;
    }

    /* Menu tiles (2 across, square-ish) */
    .menuGrid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
    }

    .tile{
      background: rgba(243,251,247,.95);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px;
      min-height: 120px;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      font-weight: 900;
      font-size: 18px;
      color: var(--primary);
      cursor:pointer;
      user-select:none;
      box-shadow: 0 10px 24px rgba(0,0,0,.05);
    }

    .tile:hover{
      background: rgba(191,236,224,.55);
      border-color: rgba(24,160,122,.4);
    }

    .footerSingle{
      margin-top: 14px;
      display:flex;
      justify-content:center;
    }

    /* Lists */
    ul{ padding-left: 18px; margin: 10px 0 0; }
    li{ margin: 6px 0; }

    /* Historic highlighting (if your JS adds .historic to a card) */
    .historicCard{
      background: rgba(255, 220, 230, 0.55);
      border-color: rgba(190, 60, 90, 0.30);
    }

    /* Logo sizing for login */
    .logoWrap{
      display:flex;
      justify-content:center;
      margin: 10px 0 14px;
    }
    .logoWrap img{
      width: 110px;
      height: 110px;
      object-fit: contain;
      border-radius: 18px;
    }

    @media (max-width: 520px){
      .pageTitle{ font-size:24px; }
      .menuGrid{ gap:10px; }
      .tile{ min-height: 104px; font-size:16px; }
      :root{ --controlH:48px; }
    }
  </style>
</head>

<body>
  <div id="offlineBanner"></div>

  <div class="container">

    <!-- AUTH / LOGIN -->
    <section id="authView" class="card">
      <div class="pageTitle">Login</div>

      <div class="logoWrap">
        <img src="./icons/icon-192.png" alt="Routine Tracker Logo">
      </div>

      <div class="row">
        <div class="col">
          <label for="email">Email</label>
          <input id="email" type="email" placeholder="Email" autocomplete="email" />
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label for="password">Password</label>
          <input id="password" type="password" placeholder="Password" autocomplete="current-password" />
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label for="inviteCode">Invite code (required to register)</label>
          <input id="inviteCode" type="text" placeholder="Invite Code" />
        </div>
      </div>

      <!-- Buttons on same line -->
      <div class="row nowrap">
        <button id="loginBtn" class="btn col">Login</button>
        <button id="registerBtn" class="btn secondary col">Register</button>
        <button id="forgotBtn" class="btn secondary col">Forgotten Password</button>
      </div>

      <div id="authMsg" class="helpText"></div>
    </section>

    <!-- PASSWORD RESET (optional view if your JS uses it) -->
    <section id="resetView" class="card hidden">
      <div class="pageTitle">Reset Password</div>

      <div class="row">
        <div class="col">
          <label for="resetEmail">Email</label>
          <input id="resetEmail" type="email" placeholder="Email" />
        </div>
      </div>

      <div class="row">
        <button id="sendResetBtn" class="btn col">Send reset email</button>
        <button id="resetBackBtn" class="btn secondary col">Back</button>
      </div>

      <div id="resetMsg" class="helpText"></div>
    </section>

    <!-- MAIN MENU -->
    <section id="menuView" class="card hidden">
      <div class="pageTitle">Main Menu</div>

      <div class="menuGrid">
        <div class="tile" id="goSleep">Sleep</div>
        <div class="tile" id="goMeals">Meals</div>
        <div class="tile" id="goMoods">Moods</div>
        <div class="tile" id="goMedication">Medication</div>
        <div class="tile" id="goAI">Accidents &amp; Illnesses</div>
        <div class="tile" id="goExport">Export</div>
      </div>

      <div class="footerSingle">
        <button id="logoutBtn" class="btn danger" style="min-width:220px;">Log Out</button>
      </div>

      <div class="footerSingle" style="margin-top:10px;">
        <button id="adminBtn" class="btn secondary" style="min-width:220px;">Admin</button>
      </div>
    </section>

    <!-- TRACKER PAGE (your JS will fill this / show/hide sections) -->
    <section id="trackerView" class="hidden"></section>

    <!-- Accident & Illness page -->
    <section id="accidentView" class="hidden"></section>

    <!-- New Medication / Admin page -->
    <section id="addMedicationView" class="hidden"></section>

    <!-- Export page -->
    <section id="exportView" class="hidden"></section>

    <!-- Old views (kept for compatibility with your app.js hide/show list) -->
    <section id="historicRoutineView" class="hidden"></section>
    <section id="historicAIView" class="hidden"></section>

  </div>

  <!-- Supabase client -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- App logic -->
  <script src="./app.js"></script>

  <!-- Service worker -->
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", async () => {
        try {
          const reg = await navigator.serviceWorker.register("./sw.js");
          console.log("SW registered", reg.scope);
        } catch (e) {
          console.warn("SW registration failed", e);
        }
      });
    }
  </script>
</body>
</html>
