<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0f6f4f" />
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles.css" />
  <title>Routine Tracker</title>
</head>

<body>
  <h1 class="page-title">Routine Tracker</h1>

  <!-- AUTH -->
  <section id="authView" class="card stack">
    <h2 class="page-title">Login</h2>

    <div class="logoBox">
      <img id="appLogo" src="icon-512.png" alt="Routine Tracker logo" />
    </div>

    <label><strong>Email</strong></label>
    <input id="authEmail" type="email" autocomplete="email" placeholder="Email" />

    <label><strong>Password</strong></label>
    <input id="authPassword" type="password" autocomplete="current-password" placeholder="Password" />

    <label><strong>Invite code (required to register)</strong></label>
    <input id="inviteCode" type="text" placeholder="Invite Code" />

    <div class="authRow">
      <button id="btnLogin">Login</button>
      <button id="btnRegister" class="secondary">Register</button>
      <button id="btnForgot" class="secondary">Forgotten Password</button>
    </div>
  </section>

  <!-- MENU -->
  <section id="menuView" class="card stack hidden">
    <h2 class="page-title">Main Menu</h2>

    <div class="menuGrid">
      <button class="menuTile" id="btnMenuSleep">Sleep</button>
      <button class="menuTile" id="btnMenuMeals">Meals</button>
      <button class="menuTile" id="btnMenuMoods">Moods</button>
      <button class="menuTile" id="btnMenuMeds">Medication</button>
      <button class="menuTile" id="btnMenuAI">Accidents<br>&amp; Illnesses</button>
      <button class="menuTile" id="btnMenuSummary">Daily<br>Summary</button>

      <button class="menuTile secondary" id="btnMenuAdmin">Admin</button>
      <button class="menuTile dangerBtn" id="btnLogout">Log Out</button>
    </div>
  </section>

  <!-- ADMIN -->
  <section id="adminView" class="card stack hidden">
    <div class="dayBar">
      <div class="dayBarLeft">
        <button id="adminBack" class="secondary miniBtn">Main<br>Menu</button>
      </div>
      <div></div>
    </div>

    <h2 class="page-title">Admin</h2>

    <div class="card stack">
      <h3>Add Child</h3>
      <input id="newChildName" type="text" placeholder="Child name (e.g. Freddie)" />
      <button id="btnAddChild">Save</button>
    </div>

    <div class="card stack">
      <h3>New Medication</h3>
      <div class="row">
        <input id="newMedName" type="text" placeholder="Name (e.g. Calpol)" />
        <input id="newMedUnit" type="text" placeholder="Unit (ml/mg)" />
      </div>
      <button id="btnAddMed">Save</button>
    </div>
  </section>

  <!-- SLEEP -->
  <section id="sleepView" class="card stack hidden">
    <h2 class="page-title">Sleep Tracker</h2>

    <div class="dayBar">
      <div class="dayBarLeft">
        <button id="sleepPrev" class="secondary miniBtn">◀</button>
        <button id="sleepNext" class="secondary miniBtn">▶</button>
        <input id="sleepDatePick" class="datePick" type="date" />
      </div>
      <button id="sleepBack" class="secondary miniBtn">Main<br>Menu</button>
    </div>

    <label><strong>Child</strong></label>
    <select id="sleepChild"></select>

    <div class="row">
      <button id="btnSleepStart">Start (today only)</button>
      <button                            > End (today only)</button>
    </div>

    <h3 class="page-title">Manual sleep entry</h3>
    <div class="row">
      <input id="sleepStartManual" type="datetime-local" />
      <input id="sleepEndManual" type="datetime-local" />
    </div>

    <label><strong>Notes</strong></label>
    <textarea id="sleepNote" placeholder="Notes (optional)"></textarea>

    <button id="btnSleepManual">Save</button>

    <div>
      <strong>Total sleep:</strong> <span id="sleepTotal">0.00h</span>
    </div>
    <ul id="sleepList"></ul>
  </section>

  <!-- MEALS -->
  <section id="mealsView" class="card stack hidden">
    <h2 class="page-title">Meal Tracker</h2>

    <div class="dayBar">
      <div class="dayBarLeft">
        <button id="mealsPrev" class="secondary miniBtn">◀</button>
        <button id="mealsNext" class="secondary miniBtn">▶</button>
        <input id="mealsDatePick" class="datePick" type="date" />
      </div>
      <button id="mealsBack" class="secondary miniBtn">Main<br>Menu</button>
    </div>

    <label><strong>Child</strong></label>
    <select id="mealsChild"></select>

    <div class="row">
      <select id="mealType">
        <option>Breakfast</option>
        <option>Morning snack</option>
        <option>Lunch</option>
        <option>Afternoon snack</option>
        <option>Dinner</option>
        <option>Bottle</option>
      </select>

      <select id="mealPercent">
        <option value="0">0%</option>
        <option value="25">25%</option>
        <option value="50">50%</option>
        <option value="75">75%</option>
        <option value="100">100%</option>
      </select>
    </div>

    <input id="mealWhat" type="text" placeholder="What he ate (e.g. porridge)" />

    <div class="actionRow">
      <textarea id="mealNotes" placeholder="Meal notes"></textarea>
      <button id="btnAddMeal">Save</button>
    </div>

    <ul id="mealList"></ul>
  </section>

  <!-- MOODS -->
  <section id="moodsView" class="card stack hidden">
    <h2 class="page-title">Mood Tracker</h2>

    <div class="dayBar">
      <div class="dayBarLeft">
        <button id="moodsPrev" class="secondary miniBtn">◀</button>
        <button id="moodsNext" class="secondary miniBtn">▶</button>
        <input id="moodsDatePick" class="datePick" type="date" />
      </div>
      <button id="moodsBack" class="secondary miniBtn">Main<br>Menu</button>
    </div>

    <label><strong>Child</strong></label>
    <select id="moodsChild"></select>

    <div class="row">
      <select id="moodPeriod">
        <option>Morning</option>
        <option>Afternoon</option>
        <option>Evening</option>
      </select>

      <select id="moodValue">
        <option>Calm</option>
        <option>Happy</option>
        <option>Settled</option>
        <option>Energetic</option>
        <option>Fussy</option>
        <option>Irritable</option>
        <option>Unwell</option>
      </select>
    </div>

    <div class="actionRow">
      <textarea id="moodNotes" placeholder="Mood notes"></textarea>
      <button id="btnSaveMood">Save</button>
    </div>

    <ul id="moodList"></ul>
  </section>

  <!-- MEDS -->
  <section id="medsView" class="card stack hidden">
    <h2 class="page-title">Medication</h2>

    <div class="dayBar">
      <div class="dayBarLeft">
        <button id="medsPrev" class="secondary miniBtn">◀</button>
        <button id="medsNext" class="secondary miniBtn">▶</button>
        <input id="medsDatePick" class="datePick" type="date" />
      </div>
      <button id="medsBack" class="secondary miniBtn">Main<br>Menu</button>
    </div>

    <label><strong>Child</strong></label>
    <select id="medsChild"></select>

    <div class="row3">
      <select id="medName"></select>
      <input id="medDose" type="number" step="0.1" placeholder="Dose" />
      <input id="medTime" type="time" />
    </div>

    <div class="actionRow">
      <textarea id="medNotes" placeholder="Medication notes"></textarea>
      <button id="btnAddDose">Save</button>
    </div>

    <ul id="medList"></ul>
  </section>

  <!-- ACCIDENT & ILLNESS -->
  <section id="aiView" class="card stack hidden">
    <h2 class="page-title">Accident &amp; Illness</h2>

    <div class="dayBar">
      <div class="dayBarLeft">
        <button id="aiPrev" class="secondary miniBtn">◀</button>
        <button id="aiNext" class="secondary miniBtn">▶</button>
        <input id="aiDatePick" class="datePick" type="date" />
      </div>
      <button id="aiBack" class="secondary miniBtn">Main<br>Menu</button>
    </div>

    <label><strong>Child</strong></label>
    <select id="aiChild"></select>

    <div class="pillRow">
      <button id="pillAccident" class="pill active">Accident</button>
      <button id="pillIllness" class="pill">Illness</button>
    </div>

    <!-- Accident form -->
    <div id="accidentForm" class="stack">
      <h3>Accident</h3>

      <label>What happened</label>
      <textarea id="accWhat" placeholder="Describe what happened..."></textarea>

      <div class="row">
        <div class="stack">
          <label>Injury severity</label>
          <select id="accSeverity">
            <option>Minor</option>
            <option>Moderate</option>
            <option>Severe</option>
          </select>
        </div>

        <div class="stack">
          <label>Body area affected</label>
          <select id="accBody">
            <option>Head</option>
            <option>Face</option>
            <option>Arm</option>
            <option>Leg</option>
            <option>Torso</option>
            <option>Other</option>
          </select>
        </div>
      </div>

      <label>Where did it happen</label>
      <input id="accWhere" type="text" placeholder="e.g. living room / nursery garden" />

      <div class="row">
        <div class="stack">
          <label>Reported by</label>
          <select id="accReportedBy">
            <option>Mum</option>
            <option>Dad</option>
            <option>Nursery</option>
            <option>Other</option>
          </select>
        </div>

        <div class="stack">
          <label>Time of incident (today only)</label>
          <input id="accTime" type="time" />
        </div>
      </div>

      <label>Action taken</label>
      <textarea id="accAction" placeholder="What action was taken?"></textarea>

      <label>Safeguarding put in place</label>
      <textarea id="accSafe" placeholder="What safeguarding was put in place?"></textarea>

      <label><strong>Notes</strong></label>
      <div class="actionRow">
        <textarea id="accNotes" placeholder="Notes"></textarea>
        <button id="btnAddAccident">Save</button>
      </div>

      <h3>Accidents</h3>
      <ul id="accList"></ul>
    </div>

    <!-- Illness form -->
    <div id="illnessForm" class="stack hidden">
      <h3>Illness</h3>

      <label>Symptom</label>
      <select id="illSymptom">
        <option>Temperature</option>
        <option>Cough</option>
        <option>Runny nose</option>
        <option>Vomiting</option>
        <option>Diarrhoea</option>
        <option>Other</option>
      </select>

      <div class="row">
        <div class="stack">
          <label>Temperature (°C)</label>
          <input id="illTemp" type="number" step="0.1" placeholder="e.g. 38.2 (optional)" />
        </div>

        <div class="stack">
          <label>Time of event (today only)</label>
          <input id="illTime" type="time" />
        </div>
      </div>

      <label>Medication (optional link)</label>
      <select id="illMedLink">
        <option value="">None</option>
      </select>

      <label>Reported by</label>
      <select id="illReportedBy">
        <option>Mum</option>
        <option>Dad</option>
        <option>Nursery</option>
        <option>Other</option>
      </select>

      <label><strong>Notes</strong></label>
      <div class="actionRow">
        <textarea id="illNotes" placeholder="Notes"></textarea>
        <button id="btnAddIllness">Save</button>
      </div>

      <h3>Illnesses</h3>
      <ul id="illList"></ul>
    </div>
  </section>

  <!-- SUMMARY -->
  <section id="summaryView" class="card stack hidden">
    <h2 class="page-title">Daily Summary</h2>

    <div class="dayBar">
      <div class="dayBarLeft">
        <button id="sumPrev" class="secondary miniBtn">◀</button>
        <button id="sumNext" class="secondary miniBtn">▶</button>
        <input id="sumDatePick" class="datePick" type="date" />
      </div>
      <button id="sumBack" class="secondary miniBtn">Main<br>Menu</button>
    </div>

    <label><strong>Child</strong></label>
    <select id="sumChild"></select>

    <div class="card stack">
      <h3>Sleep</h3>
      <div class="muted">Total: <span id="sumSleepTotal">0</span></div>
      <ul id="sumSleepList"></ul>
      <button id="goSleep" class="secondary">Open Sleep</button>
    </div>

    <div class="card stack">
      <h3>Meals</h3>
      <ul id="sumMealList"></ul>
      <button id="goMeals" class="secondary">Open Meals</button>
    </div>

    <div class="card stack">
      <h3>Moods</h3>
      <ul id="sumMoodList"></ul>
      <button id="goMoods" class="secondary">Open Moods</button>
    </div>

    <div class="card stack">
      <h3>Medication</h3>
      <ul id="sumMedList"></ul>
      <button id="goMeds" class="secondary">Open Medication</button>
    </div>

    <div class="card stack">
      <h3>Accidents</h3>
      <ul id="sumAccList"></ul>
      <button id="goAIa" class="secondary">Open Accident &amp; Illness</button>
    </div>

    <div class="card stack">
      <h3>Illnesses</h3>
      <ul id="sumIllList"></ul>
      <button id="goAIb" class="secondary">Open Accident &amp; Illness</button>
    </div>
  </section>

  <!-- ✅ Supabase UMD bundle MUST be loaded BEFORE app.js -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
